{"version":3,"sources":["webpack:///./docs/kustomize.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---docs-kustomize-mdx-a17571343894292f835a.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/tanka/tanka/docs/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"kustomize-support\"\n    }}>{`Kustomize Support`}</h1>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://kustomize.io\"\n      }}>{`Kustomize`}</a>{` provides a solution for customizing Kubernetes\nmanifests in YAML.`}</p>\n    <p>{`Even though Grafana Tanka uses the `}<a parentName=\"p\" {...{\n        \"href\": \"/jsonnet/overview\"\n      }}>{`Jsonnet language`}</a>{` for\nresource definition, you can still consume kustomizations, as described below.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Warning:`}</strong>{` Keep in mind this feature is considered EXPERIMENTAL`}</p>\n    </blockquote>\n    <h2 {...{\n      \"id\": \"consuming-a-kustomization-from-jsonnet\"\n    }}>{`Consuming a Kustomization from Jsonnet`}</h2>\n    <p>{`Kustomize support is provided using the\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/grafana/jsonnet-libs/tree/master/tanka-util\"\n      }}><inlineCode parentName=\"a\">{`github.com/grafana/jsonnet-libs/tanka-util`}</inlineCode></a>{`\nlibrary.  Install it with:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`jb install github.com/grafana/jsonnet-libs/tanka-util`}</span></span></code></pre>\n    <p>{`The following example shows how to extract the individual resources of the\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/fluxcd/flux2/tree/main/manifests/bases/source-controller\"\n      }}><inlineCode parentName=\"a\">{`flux2/source-controller`}</inlineCode></a>{`\nkustomization:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"jsonnet\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`local`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` tanka `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`import`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'github.com/grafana/jsonnet-libs/tanka-util/main.libsonnet'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`;`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`local`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` kustomize `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` tanka.kustomize.`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk9\"\n          }}>{`new`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`(`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk9\"\n          }}>{`std.thisFile`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`);`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}></span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`{`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk10\"\n          }}>{`source_controller:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` kustomize.`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk9\"\n          }}>{`build`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`(path=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'flux2'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`)`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`}`}</span></span></code></pre>\n    <p>{`Kustomize takes a kustomization manifest as input. Go on an create this file\n`}<inlineCode parentName=\"p\">{`flux2/kustomization.yaml`}</inlineCode>{` relative to above jsonnet:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"yaml\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk11\"\n          }}>{`apiVersion`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`kustomize.config.k8s.io/v1beta1`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk11\"\n          }}>{`kind`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`Kustomization`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk11\"\n          }}>{`resources`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`:`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`-`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`https://github.com/fluxcd/flux2/archive/v0.4.3.zip//flux2-0.4.3/manifests/bases/source-controller`}</span></span></code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Important:`}</strong>{` You MUST include the `}<inlineCode parentName=\"p\">{`.new(std.thisFile)`}</inlineCode>{` part in the import.\nThis is what tells Tanka where you actually call `}<inlineCode parentName=\"p\">{`kustomize.build()`}</inlineCode>{` from, so\nit can find your kustomization manifest.`}</p>\n    </blockquote>\n    <br />\n    <p>{`Once invoked, the `}<inlineCode parentName=\"p\">{`$.source_controller`}</inlineCode>{` key holds the individual resources of\nthe kustomization as a regular Jsonnet object that looks roughly like so:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"jsonnet\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`{`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'custom_resource_definition_buckets.source.toolkit.fluxcd.io'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'custom_resource_definition_gitrepositories.source.toolkit.fluxcd.io'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'custom_resource_definition_helmcharts.source.toolkit.fluxcd.io'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`'custom_resource_definition_helmrepositories.source.toolkit.fluxcd.io'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk10\"\n          }}>{`deployment_source_controller:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk10\"\n          }}>{`service_source_controller:`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` {`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`/* ... */`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` },`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`}`}</span></span></code></pre>\n    <p>{`Above can be `}<a parentName=\"p\" {...{\n        \"href\": \"/tutorial/environments#patching\"\n      }}>{`manipulated`}</a>{` in the same way as\nany other Jsonnet data.`}</p>\n    <h2 {...{\n      \"id\": \"working-with-kustomize\"\n    }}>{`Working with Kustomize`}</h2>\n    <p>{`Tanka, like Jsonnet, is hermetic. It `}<strong parentName=\"p\">{`always yields the same resources`}</strong>{` when\nthe project is strictly self-contained.`}</p>\n    <p>{`Kustomize however has the ability to pull\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://kubectl.docs.kubernetes.io/references/kustomize/kustomization/resource/\"\n      }}>{`resources`}</a>{`\nfrom different sources at runtime, which violates above requirement. This is\nalso apparent in the example above.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Important:`}</strong>{` Due to the nature of Kustomize, it is not feasible to ensure\nhermetic and reproducible kustomize builds from within Tanka. Beware of that\nwhen using Kustomize.`}</p>\n    </blockquote>\n    <h2 {...{\n      \"id\": \"troubleshooting\"\n    }}>{`Troubleshooting`}</h2>\n    <h3 {...{\n      \"id\": \"kustomize-executable-missing\"\n    }}>{`Kustomize executable missing`}</h3>\n    <p>{`Kustomize support in Tanka requires the `}<inlineCode parentName=\"p\">{`kustomize`}</inlineCode>{` binary installed on your\nsystem and available on the `}<inlineCode parentName=\"p\">{`$PATH`}</inlineCode>{`. If Kustomize is not installed, you will see\nthis error message:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`evaluating jsonnet: RUNTIME ERROR: Expanding Kustomize: exec: \"kustomize\": executable file not found in $PATH`}</span></code></pre>\n    <p>{`To solve this, you need to\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://kubectl.docs.kubernetes.io/installation/kustomize/\"\n      }}>{`install Kustomize`}</a>{`.\nIf you cannot install it system-wide, you can point Tanka at your executable\nusing `}<a parentName=\"p\" {...{\n        \"href\": \"/env-vars#tanka_kustomize_path\"\n      }}><inlineCode parentName=\"a\">{`TANKA_KUSTOMIZE_PATH`}</inlineCode></a></p>\n    <h3 {...{\n      \"id\": \"optscalledfrom-unset\"\n    }}>{`opts.calledFrom unset`}</h3>\n    <p>{`This occurs, when Tanka was not told where it `}<inlineCode parentName=\"p\">{`kustomize.build()`}</inlineCode>{` was invoked\nfrom. This most likely means you didn't call `}<inlineCode parentName=\"p\">{`new(std.thisFile)`}</inlineCode>{` when importing `}<inlineCode parentName=\"p\">{`tanka-util`}</inlineCode>{`:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"jsonnet\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`local`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` tanka `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`import`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`\"github.com/grafana/jsonnet-libs/tanka-util/main.libsonnet\"`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`;`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk4\"\n          }}>{`local`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` helm `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` tanka.helm.`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk9\"\n          }}>{`new`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`(`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk9\"\n          }}>{`std.thisFile`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`);`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`                       ↑ This is important`}</span></span></code></pre>\n    <h3 {...{\n      \"id\": \"failed-to-find-kustomization\"\n    }}>{`Failed to find kustomization`}</h3>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helmTemplate: Failed to find a kustomization at 'flux2': No such file or directory.`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helmTemplate: Failed to find a kustomization at '/home/user/stuff/tanka/environments/default/flux2': No such file or directory.`}</span></code></pre>\n    <p>{`Tanka failed to locate your kustomization on the filesystem. It looked at the\nrelative path you provided in `}<inlineCode parentName=\"p\">{`kustomize.build()`}</inlineCode>{`, starting from the directory\nof the file you called `}<inlineCode parentName=\"p\">{`kustomize.build()`}</inlineCode>{` from.`}</p>\n    <p>{`Please check there is actually a valid kustomization at this place.`}</p>\n\n    <style {...{\n      \"className\": \"vscode-highlight-styles\"\n    }}>{`\n  \n  .material-theme-darker {\nbackground-color: #212121;\ncolor: #EEFFFF;\n}\n\n.material-theme-darker .mtk1 { color: #FFFFFF; }\n.material-theme-darker .mtk2 { color: #212121; }\n.material-theme-darker .mtk3 { color: #545454; }\n.material-theme-darker .mtk4 { color: #F78C6C; }\n.material-theme-darker .mtk5 { color: #89DDFF; }\n.material-theme-darker .mtk6 { color: #C3E88D; }\n.material-theme-darker .mtk7 { color: #FFCB6B; }\n.material-theme-darker .mtk8 { color: #EEFFFF; }\n.material-theme-darker .mtk9 { color: #82AAFF; }\n.material-theme-darker .mtk10 { color: #FF5370; }\n.material-theme-darker .mtk11 { color: #F07178; }\n.material-theme-darker .mtk12 { color: #C792EA; }\n.material-theme-darker .mtk13 { color: #EEFFFF90; }\n.material-theme-darker .mtk14 { color: #65737E; }\n.material-theme-darker .mtk15 { color: #B2CCD6; }\n.material-theme-darker .mtk16 { color: #C17E70; }\n.material-theme-darker .mtki { font-style: italic; }\n.material-theme-darker .mtkb { font-weight: bold; }\n.material-theme-darker .mtku { text-decoration: underline; text-underline-position: under; }\n`}</style>\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}